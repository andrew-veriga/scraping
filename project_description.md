### **Отчет по проекту "discord-sui-analyzer"**

#### **1. Цели проекта**

Основная цель проекта — автоматический анализ чат-логов из Discord-канала, посвященного блокчейну Sui. Система решает следующие задачи:

*   **Группировка сообщений:** Сообщения из плоского списка группируются в осмысленные диалоги (треды) на основе логики ответов и контекста.
*   **Идентификация технических обсуждений:** С помощью анализа содержания, система отбирает обсуждения, связанные с техническими проблемами и вопросами.
*   **Извлечение решений:** Для каждого технического треда система пытается найти сообщение, которое является ответом или решением проблемы.
*   **Классификация решений:** Решениям присваивается статус:
    *   `resolved`: Решение подтверждено автором вопроса.
    *   `suggestion`: Предложено решение, но нет подтверждения его эффективности.
    *   `unresolved`: Решение не найдено.
    *   `outside`: Решение отсылает к внешним ресурсам (например, в техподдержку другого сервиса).
*   **Генерация отчетов:** В конечном итоге создается словарь всех найденных проблем и их решений в формате JSON, а также генерируется наглядный отчет в формате Markdown и HTML.

Конечная цель — создать базу знаний (FAQ) из реальных проблем и решений, обсуждаемых в сообществе, для портала поддержки Sui.

#### **2. Способы получения первичных данных**

На данный момент сбор данных устроен следующим образом:

*   **Источник:** Первичные данные — это экспорт сообщений из Discord, который вручную сохраняется в файл `data/discord_messages.xlsx`.
*   **Загрузка и обработка:** Сервис `data_loader` (`app/services/data_loader.py`) использует библиотеку `pandas` для чтения этого Excel-файла. В процессе загрузки данные предобрабатываются:
    *   Типы данных колонок приводятся к нужным форматам (например, ID сообщений к строкам).
    *   Unix Timestamp конвертируется в стандартный формат `DateTime`.
    *   Создается дополнительное поле `DatedMessage` для удобства анализа.

Процесс является полуавтоматическим и требует предварительной выгрузки данных из Discord.

#### **3. Способы хранения информации**

Промежуточные и итоговые результаты анализа сохраняются в директории `results/`:

*   **Промежуточные JSON-файлы:** В ходе выполнения конвейера (`full-process`) создаются временные файлы:
    *   `*_gathering.json`: Результаты первичной группировки сообщений в треды.
    *   `*_technical.json`: Треды, отфильтрованные как технические.
    *   `*_solutions.json`: Треды с обобщенными проблемами и найденными решениями.
*   **Основной словарь решений:** Главный результат работы — файл `solutions_dict.json`. Он хранит в себе структурированный словарь, где ключ — это ID темы, а значение — объект с полной информацией о треде, включая заголовок, решение, статус и все ID сообщений. Этот файл постоянно обновляется при обработке новых данных.
*   **Финальный отчет:** На основе `solutions_dict.json` генерируется отчет `solutions_report.md` (и его HTML-версия), который в удобочитаемом виде представляет все найденные проблемы и их решения.

#### **4. Предложения по дальнейшему улучшению проекта**

1.  **Автоматизация сбора данных:** — отказаться от ручного экспорта `.xlsx` файла. Следует интегрировать **Discord API** для прямого получения сообщений из канала в реальном времени или по расписанию. Это полностью автоматизирует конвейер.

2.  **Использование базы данных:** Вместо хранения промежуточных данных и итогового словаря в `solutions_dict.json` перейти на использование базы данных (например,  **PostgreSQL** для масштабируемости). Это даст следующие преимущества:
    *   **Надежность:** Снизится риск повреждения файла при записи.
    *   **Масштабируемость:** Более эффективная работа с большими объемами данных.
    *   **Гибкость запросов:** Возможность легко фильтровать и запрашивать данные (например, "показать все нерешенные проблемы за последнюю неделю").

3.  **Конфигурации:** Сейчас пути к файлам и интервалы обработки заданы в `configs/config.yaml`. Необходимо для каждого источника данных (не только Discord SUI support ) создать свою собственную конфигурацию. В ней также сохранять префиксы файлов хранения промежуточных данных или идентификаторы источников на SQL сервере.

4.  **UI корректора:** где человек сможет просматривать результаты разбора логов и править его вручную. Примерный набор действий, которые необходимы для такой ручной корректуры:
 * перенести последовательность в другую беседу, 
 * изменить статус решения беседы, и т.д. 
По этим действиям создавать few-shot prompting для улучшения последующих результатов LLM.

5.  **RAG-хранилище:** - сохранять в RAG решения со статусом `resolved` для определения оригинальности решения по семантическому поиску. 